(()=>{var t,e,r,n,o,a,s,i,c={33:t=>{function e(t){document.querySelector(t).classList.add("active")}function r(t){document.querySelector(t).classList.remove("active");for(var e=arguments.length,r=new Array(e>1?e-1:0),n=1;n<e;n++)r[n-1]=arguments[n];r.length>0&&r[0](r[1])}t.exports={addActiveClass:e,removeActiveClass:r,errorHandler:function(t){console.error(t),alert("There was an authentication error, please log in again"),window.location.href="/",r("#loading"),r("#loggedin",e,"#login")}}},561:function(t,e,r){var n=this,o=r(754),a=r(21).getOrRemoveTracks,s=r(33).removeActiveClass,i=r(33).addActiveClass,c=r(33).errorHandler,l=[],u=0,p=new o,y=function(t){s(".playlists"),console.log("== start displaying playlists =="),setTimeout((function(){document.querySelector(".playlists").innerHTML="".concat('<li class="playlist-header">\n      Playlists\n    </li>'),function(t){var e=t.map((function(t){return'\n      <li id="'.concat(t.id,'" class="playlist">\n        <div class="playlist-info">\n          <div class="playlist-name">').concat(t.name,'<span class="playlist-num-tracks"> [').concat(t.totalTracks,' tracks]</span></div> \n          <div class="playlist-owner">Owned by ').concat(t.owner,'</div>  \n        </div>\n        <div id="track-info-').concat(t.id,'" class="tracks"></div>\n      </li>\n    ')})).join("");document.querySelector(".playlists").innerHTML+="".concat(e),i(".playlists")}(t),document.querySelectorAll(".playlist-info").forEach((function(t){var e=t.childNodes[3].textContent.match(/Owned by (.*)/)[1],r=t.childNodes[1].childNodes[1].textContent.match(/([0-9]+) /)[1];t.addEventListener("click",a.bind(n,t.parentNode.id,e,r))})),console.log("== finish displaying playlists ==")}),500)};document.querySelector("input").addEventListener("keyup",(function(){var t;""===this.value?y(l):y((t=this.value.toLowerCase(),l.filter((function(e){return e.name.toLowerCase().includes(t)||e.owner.toLowerCase().includes(t)}))))})),t.exports={accessPlaylist:function(t){return new Promise((function(e,r){e(p.setAccessToken(t))})).then((function(t){return Promise.resolve(p.getMe()).then((function(t){return s("#loading",i,"#loggedin"),document.querySelector(".display-name").textContent=t.id,document.querySelector(".playlists").innerHTML='<p class="loading"><i class="fa fa-refresh fa-spin fa-3x fa-fw"></i></p>',t.id})).catch((function(t){return Promise.reject(t)}))})).then((function(t){return e=t,Promise.resolve(p.getUserPlaylists({limit:1})).then((function(t){return u=t.total,console.log("Number of playlists: ".concat(t.total)),document.querySelector(".number-of-playlists").textContent=t.total,e})).catch((function(t){return Promise.reject(t)}));var e})).then((function(t){return function(t){var e=[];console.log("== start retrieving playlists ==");for(var r=0;r<u;r+=20)e.push(p.getUserPlaylists(t,{offset:r}).then((function(t){t.items.forEach((function(t){l.push({owner:t.owner.id,name:t.name,id:t.id,totalTracks:t.tracks.total})}))})).catch((function(t){return Promise.reject(t)})));return Promise.all(e).then(console.log("== finished retrieving playlists ==")).catch((function(t){return Promise.reject(t)}))}(t)})).then((function(t){return y(l)})).catch((function(t){c(t)}))}}},21:function(t,e,r){var n=this,o=r(754),a=r(33).removeActiveClass,s=r(33).addActiveClass,i=r(33).errorHandler,c=new o,l=[],u=function(t,e,r){var n=[];console.log("== start retrieving tracks ==");for(var o=0;o<r;o+=100)n.push(c.getPlaylistTracks(e,t,{offset:o}).then((function(t){t.items.forEach((function(t){var e=t.track.id,r=t.track.name,n=t.track.album.name,o=t.track.artists.map((function(t){return t.name}));l.push({id:e,name:r,album:n,artists:o})}))})).catch((function(t){return Promise.reject(t)})));return Promise.all(n).then(console.log("== finished retrieving tracks ==")).catch((function(t){return Promise.reject(t)}))},p=function(t,e){console.log("== displaying ".concat(e.length," tracks ==")),document.getElementById("track-info-".concat(t)),document.getElementById("track-info-".concat(t)).innerHTML='<table class="track-table"> \n      <tr class="track-heading">\n        <th class="track-name">Name</th>\n        <th class="track-album">Album</th>\n        <th class="track-artists">Artists <span id="dl-'.concat(t,'" class="download"><i class="fa fa-download" aria-hidden="true"></i></span></th>\n      </tr>\n      ').concat(function(t,e){return e.map((function(e){return'<tr class="tracks-'.concat(t,'">\n      <td class="track-name">').concat(e.name,'</td> \n      <td class="track-album">').concat(e.album,'</td> \n      <td class="track-artists">').concat(e.artists.join("; "),"</td>\n    </tr>")})).join("")}(t,e)," \n    </table>");var r=document.getElementById("dl-".concat(t));s("#track-info-".concat(t)),r.addEventListener("click",d.bind(n,t))},y=function(t,e){return document.getElementById(t).querySelector(".playlist-info").querySelector(e).textContent};function d(t){console.log("== downloading tracks ==");var e=y(t,".playlist-owner"),r=y(t,".playlist-name"),n="".concat(e,", Playlist Name: ").concat(r,"\n");n+="Name,Album,Artists\n",document.querySelectorAll(".tracks-".concat(t)).forEach((function(t){n+="".concat(Array.from(t.children)[0].textContent,",").concat(Array.from(t.children)[1].textContent,",").concat(Array.from(t.children)[2].textContent),n+="\n"}));var o=document.createElement("a");o.href="data:text/csv;charset=utf-8,"+encodeURI(n),o.target="_blank",o.download="playlist.csv",o.click()}t.exports={getOrRemoveTracks:function(t,e,r){document.getElementsByClassName("tracks-".concat(t)).length>0?(document.getElementById("track-info-".concat(t)).innerHTML="",a("#track-info-".concat(t))):(s("#track-info-".concat(t)),document.getElementById("track-info-".concat(t)).innerHTML='<p class="loading"><i class="fa fa-refresh fa-spin fa-3x fa-fw"></i></p>',function(t,e,r){l=[],u(t,e,r).then((function(e){return p(t,l)})).catch((function(t){i(t)}))}(t,e,r))}}},754:t=>{"use strict";var e,r,n,o,a,s,i,c,l=(e="https://api.spotify.com/v1",r=null,n=null,o=function(t,e){return t.abort=e,t},a=function(){var t=Array.prototype.slice.call(arguments),e=t[0],r=t.slice(1);return e=e||{},r.forEach((function(t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])})),e},s=function(t,e){var a=new XMLHttpRequest,s=function(n,o){var s=t.type||"GET";if(a.open(s,function(t,e){var r="";for(var n in e)if(e.hasOwnProperty(n)){var o=e[n];r+=encodeURIComponent(n)+"="+encodeURIComponent(o)+"&"}return r.length>0&&(t=t+"?"+(r=r.substring(0,r.length-1))),t}(t.url,t.params)),r&&a.setRequestHeader("Authorization","Bearer "+r),a.onreadystatechange=function(){if(4===a.readyState){var t=null;try{t=a.responseText?JSON.parse(a.responseText):""}catch(t){console.error(t)}a.status>=200&&a.status<300?function(t){n&&n(t),e&&e(null,t)}(t):(o&&o(a),e&&e(a,null))}},"GET"===s)a.send(null);else{var i=null;t.postData&&("image/jpeg"===t.contentType?(i=t.postData,a.setRequestHeader("Content-Type",t.contentType)):(i=JSON.stringify(t.postData),a.setRequestHeader("Content-Type","application/json"))),a.send(i)}};return e?(s(),null):function(t,e){var r;if(null!==n){var s=n.defer();t((function(t){s.resolve(t)}),(function(t){s.reject(t)})),r=s.promise}else window.Promise&&(r=new window.Promise(t));return r?new o(r,(function(){a.abort()})):null}(s)},i=function(t,e,r,n){var o={},i=null;return"object"==typeof e?(o=e,i=r):"function"==typeof e&&(i=e),"GET"!==(t.type||"GET")&&t.postData&&!n?t.postData=a(t.postData,o):t.params=a(t.params,o),s(t,i)},((c=function(){}).prototype={constructor:l}).getGeneric=function(t,e){return i({url:t},e)},c.prototype.getMe=function(t,r){return i({url:e+"/me"},t,r)},c.prototype.getMySavedTracks=function(t,r){return i({url:e+"/me/tracks"},t,r)},c.prototype.addToMySavedTracks=function(t,r,n){return i({url:e+"/me/tracks",type:"PUT",postData:t},r,n)},c.prototype.removeFromMySavedTracks=function(t,r,n){return i({url:e+"/me/tracks",type:"DELETE",postData:t},r,n)},c.prototype.containsMySavedTracks=function(t,r,n){var o={url:e+"/me/tracks/contains",params:{ids:t.join(",")}};return i(o,r,n)},c.prototype.getMySavedAlbums=function(t,r){return i({url:e+"/me/albums"},t,r)},c.prototype.addToMySavedAlbums=function(t,r,n){return i({url:e+"/me/albums",type:"PUT",postData:t},r,n)},c.prototype.removeFromMySavedAlbums=function(t,r,n){return i({url:e+"/me/albums",type:"DELETE",postData:t},r,n)},c.prototype.containsMySavedAlbums=function(t,r,n){var o={url:e+"/me/albums/contains",params:{ids:t.join(",")}};return i(o,r,n)},c.prototype.getMyTopArtists=function(t,r){return i({url:e+"/me/top/artists"},t,r)},c.prototype.getMyTopTracks=function(t,r){return i({url:e+"/me/top/tracks"},t,r)},c.prototype.getMyRecentlyPlayedTracks=function(t,r){return i({url:e+"/me/player/recently-played"},t,r)},c.prototype.followUsers=function(t,r){var n={url:e+"/me/following/",type:"PUT",params:{ids:t.join(","),type:"user"}};return i(n,r)},c.prototype.followArtists=function(t,r){var n={url:e+"/me/following/",type:"PUT",params:{ids:t.join(","),type:"artist"}};return i(n,r)},c.prototype.followPlaylist=function(t,r,n){return i({url:e+"/playlists/"+t+"/followers",type:"PUT",postData:{}},r,n)},c.prototype.unfollowUsers=function(t,r){var n={url:e+"/me/following/",type:"DELETE",params:{ids:t.join(","),type:"user"}};return i(n,r)},c.prototype.unfollowArtists=function(t,r){var n={url:e+"/me/following/",type:"DELETE",params:{ids:t.join(","),type:"artist"}};return i(n,r)},c.prototype.unfollowPlaylist=function(t,r){return i({url:e+"/playlists/"+t+"/followers",type:"DELETE"},r)},c.prototype.isFollowingUsers=function(t,r){var n={url:e+"/me/following/contains",type:"GET",params:{ids:t.join(","),type:"user"}};return i(n,r)},c.prototype.isFollowingArtists=function(t,r){var n={url:e+"/me/following/contains",type:"GET",params:{ids:t.join(","),type:"artist"}};return i(n,r)},c.prototype.areFollowingPlaylist=function(t,r,n){var o={url:e+"/playlists/"+t+"/followers/contains",type:"GET",params:{ids:r.join(",")}};return i(o,n)},c.prototype.getFollowedArtists=function(t,r){return i({url:e+"/me/following",type:"GET",params:{type:"artist"}},t,r)},c.prototype.getUser=function(t,r,n){var o={url:e+"/users/"+encodeURIComponent(t)};return i(o,r,n)},c.prototype.getUserPlaylists=function(t,r,n){var o;return"string"==typeof t?o={url:e+"/users/"+encodeURIComponent(t)+"/playlists"}:(o={url:e+"/me/playlists"},n=r,r=t),i(o,r,n)},c.prototype.getPlaylist=function(t,r,n){return i({url:e+"/playlists/"+t},r,n)},c.prototype.getPlaylistTracks=function(t,r,n){return i({url:e+"/playlists/"+t+"/tracks"},r,n)},c.prototype.getPlaylistCoverImage=function(t,r){return i({url:e+"/playlists/"+t+"/images"},r)},c.prototype.createPlaylist=function(t,r,n){var o={url:e+"/users/"+encodeURIComponent(t)+"/playlists",type:"POST",postData:r};return i(o,r,n)},c.prototype.changePlaylistDetails=function(t,r,n){return i({url:e+"/playlists/"+t,type:"PUT",postData:r},r,n)},c.prototype.addTracksToPlaylist=function(t,r,n,o){return i({url:e+"/playlists/"+t+"/tracks",type:"POST",postData:{uris:r}},n,o,!0)},c.prototype.replaceTracksInPlaylist=function(t,r,n){return i({url:e+"/playlists/"+t+"/tracks",type:"PUT",postData:{uris:r}},{},n)},c.prototype.reorderTracksInPlaylist=function(t,r,n,o,a){return i({url:e+"/playlists/"+t+"/tracks",type:"PUT",postData:{range_start:r,insert_before:n}},o,a)},c.prototype.removeTracksFromPlaylist=function(t,r,n){var o=r.map((function(t){return"string"==typeof t?{uri:t}:t}));return i({url:e+"/playlists/"+t+"/tracks",type:"DELETE",postData:{tracks:o}},{},n)},c.prototype.removeTracksFromPlaylistWithSnapshotId=function(t,r,n,o){var a=r.map((function(t){return"string"==typeof t?{uri:t}:t}));return i({url:e+"/playlists/"+t+"/tracks",type:"DELETE",postData:{tracks:a,snapshot_id:n}},{},o)},c.prototype.removeTracksFromPlaylistInPositions=function(t,r,n,o){return i({url:e+"/playlists/"+t+"/tracks",type:"DELETE",postData:{positions:r,snapshot_id:n}},{},o)},c.prototype.uploadCustomPlaylistCoverImage=function(t,r,n){var o={url:e+"/playlists/"+t+"/images",type:"PUT",postData:r.replace(/^data:image\/jpeg;base64,/,""),contentType:"image/jpeg"};return i(o,{},n)},c.prototype.getAlbum=function(t,r,n){return i({url:e+"/albums/"+t},r,n)},c.prototype.getAlbumTracks=function(t,r,n){return i({url:e+"/albums/"+t+"/tracks"},r,n)},c.prototype.getAlbums=function(t,r,n){var o={url:e+"/albums/",params:{ids:t.join(",")}};return i(o,r,n)},c.prototype.getTrack=function(t,r,n){var o={};return o.url=e+"/tracks/"+t,i(o,r,n)},c.prototype.getTracks=function(t,r,n){var o={url:e+"/tracks/",params:{ids:t.join(",")}};return i(o,r,n)},c.prototype.getArtist=function(t,r,n){return i({url:e+"/artists/"+t},r,n)},c.prototype.getArtists=function(t,r,n){var o={url:e+"/artists/",params:{ids:t.join(",")}};return i(o,r,n)},c.prototype.getArtistAlbums=function(t,r,n){return i({url:e+"/artists/"+t+"/albums"},r,n)},c.prototype.getArtistTopTracks=function(t,r,n,o){return i({url:e+"/artists/"+t+"/top-tracks",params:{country:r}},n,o)},c.prototype.getArtistRelatedArtists=function(t,r,n){return i({url:e+"/artists/"+t+"/related-artists"},r,n)},c.prototype.getFeaturedPlaylists=function(t,r){return i({url:e+"/browse/featured-playlists"},t,r)},c.prototype.getNewReleases=function(t,r){return i({url:e+"/browse/new-releases"},t,r)},c.prototype.getCategories=function(t,r){return i({url:e+"/browse/categories"},t,r)},c.prototype.getCategory=function(t,r,n){return i({url:e+"/browse/categories/"+t},r,n)},c.prototype.getCategoryPlaylists=function(t,r,n){return i({url:e+"/browse/categories/"+t+"/playlists"},r,n)},c.prototype.search=function(t,r,n,o){var a={url:e+"/search/",params:{q:t,type:r.join(",")}};return i(a,n,o)},c.prototype.searchAlbums=function(t,e,r){return this.search(t,["album"],e,r)},c.prototype.searchArtists=function(t,e,r){return this.search(t,["artist"],e,r)},c.prototype.searchTracks=function(t,e,r){return this.search(t,["track"],e,r)},c.prototype.searchPlaylists=function(t,e,r){return this.search(t,["playlist"],e,r)},c.prototype.searchShows=function(t,e,r){return this.search(t,["show"],e,r)},c.prototype.searchEpisodes=function(t,e,r){return this.search(t,["episode"],e,r)},c.prototype.getAudioFeaturesForTrack=function(t,r){var n={};return n.url=e+"/audio-features/"+t,i(n,{},r)},c.prototype.getAudioFeaturesForTracks=function(t,r){return i({url:e+"/audio-features",params:{ids:t}},{},r)},c.prototype.getAudioAnalysisForTrack=function(t,r){var n={};return n.url=e+"/audio-analysis/"+t,i(n,{},r)},c.prototype.getRecommendations=function(t,r){return i({url:e+"/recommendations"},t,r)},c.prototype.getAvailableGenreSeeds=function(t){return i({url:e+"/recommendations/available-genre-seeds"},{},t)},c.prototype.getMyDevices=function(t){return i({url:e+"/me/player/devices"},{},t)},c.prototype.getMyCurrentPlaybackState=function(t,r){return i({url:e+"/me/player"},t,r)},c.prototype.getMyCurrentPlayingTrack=function(t,r){return i({url:e+"/me/player/currently-playing"},t,r)},c.prototype.transferMyPlayback=function(t,r,n){var o=r||{};return o.device_ids=t,i({type:"PUT",url:e+"/me/player",postData:o},r,n)},c.prototype.play=function(t,r){var n="device_id"in(t=t||{})?{device_id:t.device_id}:null,o={};return["context_uri","uris","offset","position_ms"].forEach((function(e){e in t&&(o[e]=t[e])})),i({type:"PUT",url:e+"/me/player/play",params:n,postData:o},"function"==typeof t?t:{},r)},c.prototype.queue=function(t,r,n){var o="device_id"in(r=r||{})?{uri:t,device_id:r.device_id}:{uri:t};return i({type:"POST",url:e+"/me/player/queue",params:o},r,n)},c.prototype.pause=function(t,r){var n="device_id"in(t=t||{})?{device_id:t.device_id}:null;return i({type:"PUT",url:e+"/me/player/pause",params:n},t,r)},c.prototype.skipToNext=function(t,r){var n="device_id"in(t=t||{})?{device_id:t.device_id}:null;return i({type:"POST",url:e+"/me/player/next",params:n},t,r)},c.prototype.skipToPrevious=function(t,r){var n="device_id"in(t=t||{})?{device_id:t.device_id}:null;return i({type:"POST",url:e+"/me/player/previous",params:n},t,r)},c.prototype.seek=function(t,r,n){var o={position_ms:t};return"device_id"in(r=r||{})&&(o.device_id=r.device_id),i({type:"PUT",url:e+"/me/player/seek",params:o},r,n)},c.prototype.setRepeat=function(t,r,n){var o={state:t};return"device_id"in(r=r||{})&&(o.device_id=r.device_id),i({type:"PUT",url:e+"/me/player/repeat",params:o},r,n)},c.prototype.setVolume=function(t,r,n){var o={volume_percent:t};return"device_id"in(r=r||{})&&(o.device_id=r.device_id),i({type:"PUT",url:e+"/me/player/volume",params:o},r,n)},c.prototype.setShuffle=function(t,r,n){var o={state:t};return"device_id"in(r=r||{})&&(o.device_id=r.device_id),i({type:"PUT",url:e+"/me/player/shuffle",params:o},r,n)},c.prototype.getShow=function(t,r,n){var o={};return o.url=e+"/shows/"+t,i(o,r,n)},c.prototype.getShows=function(t,r,n){var o={url:e+"/shows/",params:{ids:t.join(",")}};return i(o,r,n)},c.prototype.getMySavedShows=function(t,r){return i({url:e+"/me/shows"},t,r)},c.prototype.addToMySavedShows=function(t,r,n){return i({url:e+"/me/shows",type:"PUT",postData:t},r,n)},c.prototype.removeFromMySavedShows=function(t,r,n){return i({url:e+"/me/shows",type:"DELETE",postData:t},r,n)},c.prototype.containsMySavedShows=function(t,r,n){var o={url:e+"/me/shows/contains",params:{ids:t.join(",")}};return i(o,r,n)},c.prototype.getShowEpisodes=function(t,r,n){return i({url:e+"/shows/"+t+"/episodes"},r,n)},c.prototype.getEpisode=function(t,r,n){var o={};return o.url=e+"/episodes/"+t,i(o,r,n)},c.prototype.getEpisodes=function(t,r,n){var o={url:e+"/episodes/",params:{ids:t.join(",")}};return i(o,r,n)},c.prototype.getAccessToken=function(){return r},c.prototype.setAccessToken=function(t){r=t},c.prototype.setPromiseImplementation=function(t){var e=!1;try{var r=new t((function(t){t()}));"function"==typeof r.then&&"function"==typeof r.catch&&(e=!0)}catch(t){console.error(t)}if(!e)throw new Error("Unsupported implementation of Promises/A+");n=t},c);"object"==typeof t.exports&&(t.exports=l)}},l={};function u(t){var e=l[t];if(void 0!==e)return e.exports;var r=l[t]={exports:{}};return c[t].call(r.exports,r,r.exports,u),r.exports}a=u(561).accessPlaylist,s=u(33).removeActiveClass,i=u(33).addActiveClass,u(33).errorHandler,t={},e=[],""!==(r=window.location.hash)&&(t[(e=/#([^&;=]+)=?([^&;]*)/g.exec(r))[1]]=decodeURIComponent(e[2])),o=(n=t).access_token,n.error?(console.log("There was an error during the authentication"),alert("There was an error during the authentication"),window.location.href="/"):o?(s("#login",i,"#loading"),a(o)):s("#loggedin",i,"#login")})();